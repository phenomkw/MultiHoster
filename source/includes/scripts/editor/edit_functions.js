var rt=0,gs=0,sepiafilter=0,flipped_h=0,flipped_v=0;function rotate(a){$("#imageineditor").rotate({animateTo:a,easing:$.easing.easeInOutExpo});rt=a}function makeitgray(){gs==0?(grayscale($("#imageineditor")),gs=1):gs==1&&(grayscale.reset($("#imageineditor")),gs=0)}
function doPixastic(a){a=="sepia"&&sepiafilter==0?(Pixastic.process(document.getElementById("imageineditor"),"sepia"),sepiafilter=1):a=="fliph"&&flipped_h==0?(Pixastic.process(document.getElementById("imageineditor"),"fliph"),flipped_h=1):a=="flipv"&&flipped_v==0&&(Pixastic.process(document.getElementById("imageineditor"),"flipv"),flipped_v=1)}
function undoChanges(){gs==1&&(grayscale.reset($("#imageineditor")),gs=0);rt!=0&&rotate(0);if(sepiafilter==1||flipped_v==1||flipped_h==1)Pixastic.revert(document.getElementById("imageineditor")),flipped_h=flipped_v=sepiafilter=0}
function saveImage(a){$("#response").html('<strong>Please wait....</strong><br /><img src="css/images/progress_bar.gif">');$.post("users.php?act=imgedit_process",{file_id:a,rotate:rt,grayscale:gs,sepia:sepiafilter,flip_h:flipped_h,flip_v:flipped_v},function(a){a=="fine"?($("#response").html("All done!"),location.reload()):$("#response").html("<b>Error!"+a+"</b>")})};
